#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

//maximalni hodnota zrychleni, ktera bude zaznamenana (256 = 1g)
#define TRIM1  150

//kalibrace os, zalezi na senzoru zrychleni a jeho upevneni
#define OFFSET_X 12               
#define OFFSET_Y 25

#define SUM_DELAY 4
#define THRESHOLD_SUM 200
#define REFRESH_TIME 50000          // = 1000000/obnovaci frekvence
// umisteni kurzoru
unsigned int Xpos = 5;
unsigned int Ypos = 5;
  
int Xsum = 0;
int Ysum = 0;

float timeStart, timeEnd;
unsigned long refreshTmp; 


//promenne pro menu
volatile byte pause = 0;
//volatile byte menu = 0;
//volatile byte menuSelection = 0;
volatile byte collision = 1;

// char *menuItems[] = {"START","DIFFICULITY","MENU ITEM 3", "MENU ITEM 4"};
const byte interrupt = 2;

int ADXL345 = 0x53;

Adafruit_SSD1306 display(128, 64,&Wire, 4);

/*

*/
// data urovne ulozena ve formatu 1-bitove indexovane bitmapy (bila je volny prostor a cerne jsou prekazky(na displeji je to zobrazeno naopak))
// PROGMEM ulozi data do flash pameti misto RAM cteme je pomoci: pgm_read_byte_near

const byte level1[] PROGMEM {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFF, 0xFB, 0xFF, 0xFF, 0xFF, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFD, 0x7F, 0xFF, 0xFD, 0xFF, 0xFF, 0xFF, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFB, 0xBF, 0xFF, 0xFE, 0xFF, 0xFF, 0xFF, 0x6E, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF7, 0xDF, 0xFF, 0xFF, 0x7F, 0xFF, 0xFF, 0x76, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xEF, 0xEF, 0xFF, 0xFF, 0xBF, 0xFF, 0xFF, 0x42, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xDF, 0xF7, 0xFF, 0xFF, 0xDF, 0xFF, 0xFF, 0x76, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xBF, 0xFB, 0xFE, 0xFF, 0xEF, 0xFF, 0xFF, 0x6E, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0xFD, 0xFF, 0x7F, 0xF7, 0xFE, 0xFF, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFE, 0xFF, 0xBF, 0xFB, 0xFE, 0xFF, 0x46, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 0x7F, 0xDF, 0xFD, 0xFE, 0xFF, 0x5A, 
0xFF, 0xFE, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFB, 0xFF, 0xFF, 0xBF, 0xEF, 0xFE, 0xFE, 0xFF, 0x5A, 
0xFF, 0xFE, 0x7F, 0xC0, 0x00, 0x00, 0xFF, 0xF7, 0xFF, 0xFF, 0xDF, 0xF7, 0xFF, 0x7E, 0xFF, 0x5A, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFF, 0xFF, 0xEF, 0xFB, 0xFF, 0x7E, 0xFF, 0x5A, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFF, 0xFF, 0xEF, 0xFD, 0xFF, 0x7E, 0xFF, 0x46, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x7E, 
0x07, 0xC0, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFE, 0x7E, 
0x07, 0xC0, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x5A, 
0x0F, 0xE0, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x5A, 
0x1F, 0xF0, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x52, 
0x3F, 0xF8, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x4A, 
0x7F, 0xFC, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x5A, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFC, 0x00, 0x0F, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0x7F, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x46, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xFE, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x5E, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0x7E, 0xFF, 0x4E, 
0xFF, 0xFE, 0x03, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xFB, 0xFF, 0xDF, 0xFE, 0xFF, 0x7E, 0xFF, 0x5E, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xF7, 0xFF, 0xBF, 0xFE, 0xFF, 0x7E, 0xFF, 0x46, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xEF, 0xFF, 0x7F, 0xFE, 0xFF, 0x7E, 0xFF, 0x7E, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xDF, 0xFE, 0xFF, 0xFD, 0xFF, 0x7E, 0xFE, 0x00, 
0x00, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0xBF, 0xFD, 0xFF, 0xFB, 0xFF, 0x7E, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFF, 0x7F, 0xFB, 0xFF, 0xF7, 0xFE, 0xFE, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFE, 0xFF, 0xF7, 0xFF, 0xEF, 0xFD, 0xFE, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFD, 0xFF, 0xEF, 0xFF, 0xDF, 0xFB, 0xFE, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFB, 0xFF, 0xDF, 0xFF, 0xBF, 0xF7, 0xFC, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xF7, 0xFF, 0xBF, 0xFF, 0x7F, 0xEF, 0xF8, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFF, 0x7F, 0xFE, 0xFF, 0xDF, 0xF0, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xFD, 0xFF, 0xBF, 0xE0, 0x00, 0x00, 
0x00, 0x00, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xFB, 0xFF, 0x7F, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xC0, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xF7, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFD, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xFB, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xF7, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xEF, 0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xE0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xE0, 0x03, 0xFF, 0xFE, 0xFF, 
0xFF, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xE0, 0x03, 0xFF, 0xFE, 0xFF, 
0xFF, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFE, 0xFF, 0xEF, 0xE0, 0x03, 0xFF, 0xFE, 0xFF, 
0xFF, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFF, 0xFF, 0xEF, 0xE0, 0x03, 0xFF, 0xFE, 0xFF, 
0xFF, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xEF, 0xFF, 0xFF, 0xEF, 0xE0, 0x03, 0xFF, 0xFE, 0xFF, 
0xFF, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xF7, 0xFF, 0xFF, 0xDF, 0xE0, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFD, 0xFF, 0xFB, 0xFF, 0xFF, 0xBF, 0xE0, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 0x7F, 0xC0, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFE, 0xFF, 0x80, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0xFD, 0xFF, 0x00, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xBF, 0xFB, 0xFE, 0x00, 0x03, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xDF, 0xF7, 0xFF, 0xFF, 0xFF, 0xFD, 0xFE, 0xFF, 
0x7F, 0x7E, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xEF, 0xEF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 
0x7F, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xF7, 0xDF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 
0x7F, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFB, 0xBF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 
0x7F, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFD, 0x7F, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 
0x7F, 0xFE, 0x7F, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFF, 0xFF, 
0x7F, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00 };

